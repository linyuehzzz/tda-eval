from numpy import logical_and

def is_valid(table_data):
    FOD1P = [1100,1101,1102,1103,1104,1105,1106,1199,1301,1302,1303,1401,1501,1901,1902,1903,1904,2001,
             2100,2101,2102,2105,2106,2107,2201,2300,2301,2303,2304,2305,2306,2307,2308,2309,2310,2311,
             2312,2313,2314,2399,2400,2401,2402,2403,2404,2405,2406,2407,2408,2409,2410,2411,2412,2413,
             2414,2415,2416,2417,2418,2419,2499,2500,2501,2502,2503,2504,2599,2601,2602,2603,2901,3201,
             3202,3301,3302,3401,3402,3501,3600,3601,3602,3603,3604,3605,3606,3607,3608,3609,3611,3699,
             3700,3701,3702,3801,4000,4001,4002,4005,4006,4007,4101,4801,4901,5000,5001,5002,5003,5004,
             5005,5006,5007,5008,5098,5102,5200,5201,5202,5203,5205,5206,5299,5301,5401,5402,5403,5404,
             5500,5501,5502,5503,5504,5505,5506,5507,5599,5601,5701,5901,6000,6001,6002,6003,6004,6005,
             6006,6007,6099,6100,6102,6103,6104,6105,6106,6107,6108,6109,6110,6199,6200,6201,6202,6203,
             6204,6205,6206,6207,6209,6210,6211,6212,6299,6402,6403]
    
    SOCP = ["1110XX","111021","112011","112021","112022","112030","113012","113013","113021","113031","113111",
            "113121","113131","113051","113061","113071","119013","119021","119030","119041","119051","119070",
            "119081","119111","119121","119141","119151","119161","1191XX","131011","131021","131022","131023",
            "131030","131041","131051","131070","131081","131082","131111","131121","131131","131141","131151",
            "131161","131199","132011","132020","132031","132041","132051","132052","132053","132061","132070",
            "132081","132082","1320XX","151221","151211","151212","151251","151252","151253","151254","151255",
            "151230","15124X","151244","151241","151299","152011","152031","1520XX","171011","171012","171020",
            "172011","1720XX","172041","172051","172061","172070","172081","172110","172121","172131","172141",
            "1721XX","1721YY","173011","17301X","173023","17302X","173031","191010","191020","191030","1910XX",
            "192010","192021","192030","192041","19204X","192099","193011","193033","193034","19303X","193051",
            "1930XX","194010","194021","194031","1940XX","1940YY","195010","211011","211012","211013","211014",
            "211015","211019","211021","211022","211023","211029","211092","211093","21109X","212011","212021",
            "212099","2310XX","231012","232011","232093","232099","251000","252010","252020","252030","252050",
            "253041","2530XX","254010","254022","254031","259040","2590XX","271010","271021","271022","271023",
            "271024","271025","271026","27102X","272011","272012","272021","272022","272023","272030","272041",
            "272042","272091","272099","273011","273023","273031","273041","273042","273043","273091","273092",
            "273099","2740XX","274021","274030","291011","291020","291031","291041","291051","291210","291240",
            "291071","291081","291122","291123","291124","291125","291126","291127","29112X","291131","291141",
            "291151","291181","2911XX","291291","291299","292010","291292","292031","292032","292034","292035",
            "29203X","292042","292043","292052","292053","292055","292056","29205X","292061","292072","292081",
            "292090","299000","311121","311122","311131","31113X","312010","312020","319011","319091","319092",
            "319094","319095","319096","319097","31909X","331011","331012","331021","331090","332011","332020",
            "333011","333012","333021","3330XX","333050","339011","339021","339030","339091","339093","339094",
            "33909X","351011","351012","352010","352021","353011","353023","353031","353041","359011","359021",
            "359031","359099","371011","371012","37201X","372012","372021","373011","373013","37301X","391000",
            "392011","392021","393010","393031","3930XX","394031","3940XX","395011","395012","395092","395094",
            "39509X","396010","397010","399011","399031","399032","399041","399099","411011","411012","412010",
            "412021","412022","412031","413011","413021","413031","413041","413091","414010","419010","419020",
            "419031","419041","419091","419099","431011","432011","432021","432099","433011","433021","433031",
            "433051","433061","433071","4330XX","434031","434041","434051","434061","434071","434081","434111",
            "434121","434131","434141","434XXX","434161","434171","434181","434YYY","435011","435021","435031",
            "435032","435041","435051","435052","435053","435061","435071","435111","436011","436012","436013",
            "436014","439021","439022","439041","439051","439061","439071","439081","439111","439XXX","451011",
            "452011","452041","4520XX","453031","454011","454020","471011","472011","472031","472040","472050",
            "472061","472070","472080","472111","472121","472130","472140","472151","472152","472161","472181",
            "472211","472221","472231","472XXX","473010","474011","474021","474031","474041","474051","474061",
            "4740XX","4750YY","475020","475032","475040","4750XX","491011","492011","492020","492091","492092",
            "49209X","492097","492098","493011","493021","493022","493023","493031","493040","493050","493090",
            "499010","499021","499031","49904X","499043","499044","499051","499052","499060","499071","499091",
            "499094","499096","499098","4990XX","511011","512020","512031","512041","5120XX","513011","513020",
            "513091","513092","513093","513099","519160","514020","514031","514033","51403X","514041","514050",
            "5140XX","514111","514120","514XXX","515111","515112","515113","516011","516021","516031","516040",
            "516050","516060","516093","51609X","517011","517021","517041","517042","5170XX","518010","518021",
            "518031","518090","519010","519020","519030","519041","519051","519061","519071","519080","519111",
            "519120","519151","519191","519194","519195","519196","519197","519198","5191XX","531000","532010",
            "532020","532031","533011","533051","533052","533030","533053","533054","533099","534010","534031",
            "5340XX","5350XX","535020","536021","536030","536051","536061","5360XX","537021","5370XX","537051",
            "537061","537062","537063","537064","537065","537070","537081","5371XX","551010","552010","553010",
            "559830","999920"]

             
    cond1 = (table_data["DIS"] >= 1) & (table_data["DIS"] <= 2)

    cond2 = (table_data["AGEP"] < 15) & (table_data["MSP"].isna()) | ((table_data["AGEP"] >= 15) 
    & (table_data["MSP"] >= 1) & (table_data["MSP"] <= 6))

    cond3 = (table_data["AGEP"] < 1) & (table_data["MIG"].isna()) | ((table_data["AGEP"] >= 1) 
    & (table_data["MIG"] >= 1) & (table_data["MIG"] <= 3))

    cond4 = (table_data["AGEP"] < 17) & (table_data["MIL"].isna()) | ((table_data["AGEP"] >= 17) 
    & (table_data["MIL"] >= 1) & (table_data["MIL"] <= 4))

    cond5 = (table_data["AGEP"] < 3) & (table_data["SCHL"].isna()) | ((table_data["AGEP"] >= 3) 
    & (table_data["SCHL"] >= 1) & (table_data["SCHL"] <= 24))

    cond6 = (table_data["SCHL"].isna()) & (table_data["FOD1P"].isna()) | ((table_data["SCHL"] >= 1) & (table_data["SCHL"] <= 20) 
    & (table_data["FOD1P"].isna())) | (table_data["SCHL"] > 20) & (table_data["FOD1P"].isin(FOD1P))

    cond7 = (table_data["HICOV"] >= 1) & (table_data["HICOV"] <= 2)
    cond8 = (table_data["PRIVCOV"] >= 1) & (table_data["PRIVCOV"] <= 2)
    cond9 = (table_data["PUBCOV"] >= 1) & (table_data["PUBCOV"] <= 2)

    cond10 = (table_data["AGEP"] < 15) & (table_data["PINCP"].isna()) | ((table_data["AGEP"] >= 15) 
    & (table_data["PINCP"] >= -19998) & (table_data["PINCP"] <= 4209995))

    cond11 = ((table_data["AGEP"] < 16) & (table_data["COW"].isna()) & (table_data["ESR"].isna()) 
    & (table_data["SOCP"].isna())) | (table_data["AGEP"] >= 16) & ((table_data["COW"].isna()) | (table_data["COW"] >= 1) 
    & (table_data["COW"] <= 9)) & ((table_data["ESR"] >= 1) & (table_data["ESR"] <= 6)) & ((table_data["SOCP"].isna()) 
    | (table_data["SOCP"].isin(SOCP)))

    cond12 = ((table_data["AGEP"] < 16) | (table_data["COW"] == 9) | (table_data["ESR"] == 3) | (table_data["ESR"] == 6) 
    | (table_data["SOCP"] == 999920)) & (table_data["JWMNP"].isna()) & (table_data["JWTRNS"].isna()) | ((table_data["AGEP"] >= 16) 
    & (table_data["COW"] != 9) & (table_data["ESR"] != 3) & (table_data["ESR"] != 6) & (table_data["SOCP"] != 999920)) & ((table_data["JWMNP"] >= 0) 
    | (table_data["JWMNP"].isna())) & (table_data["JWTRNS"].isna() | (table_data["JWTRNS"] >= 1) & (table_data["JWTRNS"] <= 12))

    cond13 = ((table_data["AGEP"] < 16) | (table_data["COW"] == 9) | (table_data["ESR"] == 3) | (table_data["ESR"] == 6) 
    | (table_data["SOCP"] == 999920) | (table_data["JWTRNS"] != 1)) & (table_data["JWRIP"].isna()) | ((table_data["AGEP"] >= 16) 
    & (table_data["COW"] != 9) & (table_data["ESR"] != 3) & (table_data["ESR"] != 6) & (table_data["SOCP"] != 999920) 
    & (table_data["JWTRNS"] == 1) & (table_data["JWRIP"] >= 1) & (table_data["JWRIP"] <= 10))

    cond14 = (table_data["POVPIP"].isna()) | (table_data["POVPIP"] >= 0) & (table_data["POVPIP"] <= 501)

    cond_list = [cond1, cond2, cond3, cond4, cond5, cond6, cond7, cond8, cond9, cond10, cond11, cond12, cond13, cond14]
    return logical_and.reduce(cond_list)